{% extends "dashboardHealthProfessional/template.html" %} {% block content %} {% load staticfiles %} {% load static %}

<style>
.row.display-flex {
  display: flex;
  flex-wrap: wrap;
}
.row.display-flex > [class*='col-'] {
  display: flex;
  flex-direction: column;
}

.box-length{
  height: 100%!important;
}

.body{
  margin: 1%!important;
}

.col-lg-4{
  padding: 0%!important;
}

.col-lg-8{
  padding-left: 1%!important;
}

.small-box-footer{
  position: absolute!important;
  bottom: 0!important;
  width: 100%!important;
}
</style>

<script src="{% static "dashboard/bowercomponents/jquery/dist/jquery.min.js" %}"></script>
<script src="{% static "dashboard/bowercomponents/bootstrap/dist/js/bootstrap.min.js" %}"></script>
<script src="{% static "dashboard/bowercomponents/morris.js/morris.min.js" %}"></script>
<script src="{% static "dashboard/bowercomponents/raphael/raphael.min.js" %}"></script>

<script>
$(function () {
  "use strict";
var line = new Morris.Line({
  element: 'line-chart',
  resize: true,
  data: [
    {y: '2011 Q1', item1: 2666},
    {y: '2012 Q1', item1: 2778},
    {y: '2013 Q1', item1: 4912},
    {y: '2014 Q1', item1: 3767},
    {y: '2015 Q1', item1: 6810},
    {y: '2016 Q1', item1: 5670},
    {y: '2017 Q1', item1: 4820},
    {y: '2018 Q1', item1: 15073},
    {y: '2019 Q1', item1: 10687},
    {y: '2020 Q1', item1: 8432}
  ],
  xkey: 'y',
  ykeys: ['item1'],
  labels: ['Item 1'],
  lineColors: ['#3c8dbc'],
  hideHover: 'auto'
});
});
</script>
<div class="body">
  <div class="row display-flex">

    <div class="col-lg-4 col-xs-6">
      <!-- small box -->
      <div class="small-box bg-primary box-length">
        <div class="inner">
          <h1><b>{{prescription_quantity}}</b></h1><br><br>
          <p>
            <h2>Prescrições na última semana</h2>
          </p>
        </div>
        <div class="icon">
          <i class="fa fa-file-excel-o"></i>
        </div>
        <a href="#" class="small-box-footer">
        Listar Prescrições <i class="fa fa-arrow-circle-right"></i>
      </a>
      </div>
    </div>

    <div class="col-lg-8 col-xs-6">

    <div class="box box-primary">
      <div class="box-header with-border">
        <h3 class="box-title">Line Chart</h3>
      </div>
      <div class="box-body chart-responsive">
        <div class="chart" id="line-chart" style="height: 200px;"></div>
      </div>
      <!-- /.box-body -->
    </div>
  </div>
</div>
  <div class="row">
      <div class="box box-solid">
        <div class="box-header with-border">
          <h4 class="box-title">Últimas Prescrições</h4>
        </div>
        <div class="box-body pull-center">
          <div class="row display-flex">
          {% for prescription in last_prescriptions %}
          <div class="col-lg-2 col-xs-6 col-md-2">
            <div class="box box-primary box-solid box-length">
              <div class="box-header with-border">
                <h3 class="box-title">{{prescription.nopatientprescription.patient|truncatechars:10}}</h3>
                <div class="box-tools pull-right">
                  <a class="js-show-prescription fa fa-eye" data-url="{% url 'show_prescription' prescription.pk %}"></a>
                </div>
              </div>
              <div class="box-body" style="margin=0%">
                {% if prescription.medicines.all.count or prescription.manipulated_medicines.all.count%}
                  <b>Medicamentos:</b>
                {% endif %}
                <ol>
                  {% for medicine in prescription.medicines.all %}
                  <li>{{ medicine.name|truncatechars:15 }}</li>
                  {% endfor %}

                  {% for medicine in prescription.manipulated_medicines.all %}
                  <li>{{ medicine.recipe_name|truncatechars:15 }}</li>
                  {% endfor %}
                </ol>

                  {% if prescription.default_exams.all.count or prescription.custom_exams.all.count%}
                    <b>Exames:</b>
                  {% endif %}
                  <ol>
                    {% for exam in prescription.default_exams.all %}
                    <li>{{ exam.description|truncatechars:15 }}</li>
                    {% endfor %}

                    {% for exam in prescription.custom_exams.all %}
                    <li>{{ exam.description|truncatechars:15 }}</li>
                    {% endfor %}
                  </ol>

                  {% if prescription.recommendation_prescription.all.count%}
                    <b>Recomendações:</b>
                  {% endif %}
                  <ol>
                    {% for recommendation in prescription.recommendation_prescription.all %}
                          <li>{{ recommendation.recommendation|truncatechars:15 }}</li>
                    {% endfor %}
                  </ol>
              </div>
            </div>
          </div>
          {%endfor%}
        </div>
        </div>
      </div>
  </div>
</div>

{%endblock %}
